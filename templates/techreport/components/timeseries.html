<div data-id="{{ timeseries.id }}" data-component="timeseries">
  {% if timeseries.subcategory %}
    {% set subcategory = timeseries.subcategory %}
    {% set id = timeseries.id %}
    {% include "techreport/components/subcategory.html" %}
  {% endif %}

  {% set selectedParam = request.args.get(subcategory.param, '') or subcategory.default %}
  {% set title = timeseries.title %}
  {% set descr = timeseries.description %}
  {% if tech_report_labels.metrics[selectedParam] %}
    {% set title = tech_report_labels.metrics[selectedParam].title %}
    {% set descr = tech_report_labels.metrics[selectedParam].description %}
  {% endif %}

  <h3>{{ title }}</h3>
  <p class="descr">{{ descr }}</p>

  {% if timeseries.summary %}
    <div class="data-summary">
      <div class="heading">
        <p>
          Latest data: <span data-slot="timestamp"></span>
        </p>
      </div>
      <div class="breakdown-list">
        {% if timeseries.viz.series.breakdown == 'client' %}
          {% for breakdown in timeseries.viz.series["values"] %}
            <div class="breakdown-item">
              <p class="breakdown-label">{{ breakdown.name }}</p>
              <p class="breakdown-value">00{% if breakdown.suffix == "%" %}.00{% endif %}{{ breakdown.suffix }}</p>
            </div>
          {% endfor %}
        {% endif %}
      </div>
    </div>
  {% endif %}

  <!-- This will be used to load the Highcharts viz into -->
  <div id="{{ timeseries.id }}-timeseries"></div>

  <button class="btn show-table" type="button" data-id="{{ timeseries.id }}">Show table</button>

  <div id="{{ timeseries.id }}-table-wrapper" class="hidden">
    {% set table = timeseries.table %}
    {% set id = timeseries.id %}
    {% set client = request.args.get('client', '')  or 'mobile' %}
    {% include "techreport/components/table.html" %}
  </div>

  <p class="meta">
    Client: <span data-slot="client">{{ request.args.get('client', '')  or 'mobile' }}</span>
  </p>
</div>
